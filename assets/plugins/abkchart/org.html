<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ORG</title>
    <!-- <link rel="stylesheet" href="./style.css"> -->
    <!-- <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/orgchart/2.1.3/css/jquery.orgchart.min.css'> -->
    <link rel="stylesheet" href="./org.css">
    <script type="text/javascript" src="jspdf.js"></script>
    <script type="text/javascript" src="html2canvas.js"></script>
</head>

<body>
    <!-- partial:index.partial.html -->
    <div id="chart-container">

        <div class="orgchart">
            <table>
                <tr>
                    <td colspan="8">
                        <div class="node">
                            <div class="title"><i class="fa fa-users symbol"></i>Lao Lao</div>
                            <div class="content">general manager</div><i class="edge verticalEdge bottomEdge fa"></i>
                            <div class="assistant-node">
                                <div class="connector"></div>
                                <div class="title"><i class="fa fa-user-circle-o symbol"></i>Dan Dan</div>
                                <div class="content">general office</div><i class="edge verticalEdge bottomEdge fa"></i>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr class="lines">
                    <td colspan="8">
                        <div class="downLine"></div>
                    </td>
                </tr>
                <tr class="lines">
                    <td class="rightLine"></td>
                    <td class="leftLine topLine"></td>
                    <td class="rightLine topLine"></td>
                    <td class="leftLine topLine"></td>
                    <td class="rightLine topLine"></td>
                    <td class="leftLine topLine"></td>
                    <td class="rightLine topLine"></td>
                    <td class="leftLine"></td>
                </tr>
                <tr class="nodes">
                    <td colspan="2">
                        <table>
                            <tr>
                                <td>
                                    <div class="node">
                                        <div class="title">Bo Miao</div>
                                        <div class="content">department manager</div><i
                                            class="edge verticalEdge topEdge fa"></i><i
                                            class="edge horizontalEdge rightEdge fa"></i><i
                                            class="edge horizontalEdge leftEdge fa"></i>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td colspan="2">
                        <table>
                            <tr>
                                <td colspan="4">
                                    <div class="node">
                                        <div class="title"><i class="fa fa-users symbol"></i>Su Miao</div>
                                        <div class="content">department manager</div><i
                                            class="edge verticalEdge topEdge fa"></i><i
                                            class="edge horizontalEdge rightEdge fa"></i><i
                                            class="edge horizontalEdge leftEdge fa"></i><i
                                            class="edge verticalEdge bottomEdge fa"></i>
                                    </div>
                                </td>
                            </tr>
                            <tr class="lines">
                                <td colspan="4">
                                    <div class="downLine"></div>
                                </td>
                            </tr>
                            <tr class="lines">
                                <td class="rightLine"></td>
                                <td class="leftLine topLine"></td>
                                <td class="rightLine topLine"></td>
                                <td class="leftLine"></td>
                            </tr>
                            <tr class="nodes">
                                <td colspan="2">
                                    <table>
                                        <tr>
                                            <td>
                                                <div class="node">
                                                    <div class="title">Tie Hua</div>
                                                    <div class="content">senior engineer</div><i
                                                        class="edge verticalEdge topEdge fa"></i><i
                                                        class="edge horizontalEdge rightEdge fa"></i><i
                                                        class="edge horizontalEdge leftEdge fa"></i>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td colspan="2">
                                    <table>
                                        <tr>
                                            <td colspan="4">
                                                <div class="node">
                                                    <div class="title"><i class="fa fa-users symbol"></i>Hei Hei</div>
                                                    <div class="content">senior engineer</div><i
                                                        class="edge verticalEdge topEdge fa"></i><i
                                                        class="edge horizontalEdge rightEdge fa"></i><i
                                                        class="edge horizontalEdge leftEdge fa"></i><i
                                                        class="edge verticalEdge bottomEdge fa"></i>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="lines">
                                            <td colspan="4">
                                                <div class="downLine"></div>
                                            </td>
                                        </tr>
                                        <tr class="lines">
                                            <td class="rightLine"></td>
                                            <td class="leftLine topLine"></td>
                                            <td class="rightLine topLine"></td>
                                            <td class="leftLine"></td>
                                        </tr>
                                        <tr class="nodes">
                                            <td colspan="2">
                                                <table>
                                                    <tr>
                                                        <td>
                                                            <div class="node">
                                                                <div class="title">Pang Pang</div>
                                                                <div class="content">engineer</div><i
                                                                    class="edge verticalEdge topEdge fa"></i><i
                                                                    class="edge horizontalEdge rightEdge fa"></i><i
                                                                    class="edge horizontalEdge leftEdge fa"></i>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td colspan="2">
                                                <table>
                                                    <tr>
                                                        <td>
                                                            <div class="node">
                                                                <div class="title">Xiang Xiang</div>
                                                                <div class="content">UE engineer</div><i
                                                                    class="edge verticalEdge topEdge fa"></i><i
                                                                    class="edge horizontalEdge rightEdge fa"></i><i
                                                                    class="edge horizontalEdge leftEdge fa"></i>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td colspan="2">
                        <table>
                            <tr>
                                <td>
                                    <div class="node">
                                        <div class="title">Hong Miao</div>
                                        <div class="content">department manager</div><i
                                            class="edge verticalEdge topEdge fa"></i><i
                                            class="edge horizontalEdge rightEdge fa"></i><i
                                            class="edge horizontalEdge leftEdge fa"></i>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td colspan="2">
                        <table>
                            <tr>
                                <td>
                                    <div class="node">
                                        <div class="title">Chun Miao</div>
                                        <div class="content">department manager</div><i
                                            class="edge verticalEdge topEdge fa"></i><i
                                            class="edge horizontalEdge rightEdge fa"></i><i
                                            class="edge horizontalEdge leftEdge fa"></i>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>

    </div>
    <a href="javascript:genPDF()">Download PDF</a>
    <button type="butoon" onclick="CreatePDFfromHTML()">Cetak</button>
</body>

</html>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script>
    function genPDF() {
        var printContents = document.getElementById('chart-container').innerHTML;
        //  var originalContents = document.body.innerHTML;

        document.body.innerHTML = printContents;

        window.print();

        //  document.body.innerHTML = originalContents;

    }
    //Create PDf from HTML...
    function CreatePDFfromHTML() {
        var HTML_Width = $(".html-content").width();
        var HTML_Height = $(".html-content").height();
        var top_left_margin = 15;
        var PDF_Width = HTML_Width + (top_left_margin * 2);
        var PDF_Height = (PDF_Width * 1.5) + (top_left_margin * 2);
        var canvas_image_width = HTML_Width;
        var canvas_image_height = HTML_Height;

        var totalPDFPages = Math.ceil(HTML_Height / PDF_Height) - 1;

        var pdf = new jsPDF('p', 'pt', 'letter');
        pdf.addHTML($('.html-content')[0], function () {
            pdf.save('Test.pdf');
        });
        // html2canvas($(".html-content")[0]).then(function (canvas) {
        // var imgData = canvas.toDataURL("image/jpeg", 1.0);
        // var pdf = new jsPDF('p', 'pt', [PDF_Width, PDF_Height]);
        // pdf.addImage(imgData, 'JPG', top_left_margin, top_left_margin, canvas_image_width, canvas_image_height);
        // for (var i = 1; i <= totalPDFPages; i++) { 
        //     pdf.addPage(PDF_Width, PDF_Height);
        //     pdf.addImage(imgData, 'JPG', top_left_margin, -(PDF_Height*i)+(top_left_margin*4),canvas_image_width,canvas_image_height);
        // }
        // pdf.save("Your_PDF_Name.pdf");
        // $(".html-content").hide();
        // });
    }
</script>